import{i as y,a as se}from"./chunk-R2O6QX4D-CX21ziz_.js";import{I as M}from"./chunk-EQTBJSBZ-CqGSPMN4.js";import{L as V}from"./chunk-I3VB6NM2-DM_9u69S.js";import{f as Y}from"./chunk-IR5DHEKS-aVJcUHa1.js";import{L as z}from"./chunk-6WKBBTKM-DFy1vcHg.js";import{r,q as Z,d as te,R as ne,aT as ie,a as ae,j as s,U as oe,d9 as re,s as le,eq as ce,H as L,T as x,b as h,ey as de,Y as A,A as g,u as pe,er as me,c_ as fe,I as ue,aY as he,t as m,K as xe,ez as ge,D as F,Z as ve,ay as je}from"./index-Bq0Gzu_3.js";import{u as _e,a as ye}from"./chunk-IEVUOT4K-u_dqqSNI.js";import{a as ke}from"./chunk-VDODP7YI-IylAwzvW.js";import{a as be}from"./chunk-OIAPXGI2-DNUkWr6K.js";import{T as S}from"./chunk-UR2E444G-BOK0EhlY.js";import"./chunk-3IW4HYUP-B8Byj9_3.js";import{N as D}from"./chunk-WX2SMNCD-CUPtxgvy.js";import{T as N}from"./trash-WzBoCVyR.js";import{P as _}from"./pencil-square-DJB9OGX8.js";import{C as we}from"./channels-zWEr-4Zl.js";import{u as O}from"./use-prompt-DKUUp42P.js";import{C}from"./container-Dy7007w-.js";import{S as Le}from"./status-badge-XGUUJdyf.js";import"./Trans-D-2atTey.js";import"./x-mark-mini-B2FnFGkK.js";import"./plus-mini-D38qrUji.js";import"./prompt-B670l_cz.js";var Ne=Object.defineProperty,k=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable,B=(e,t,n)=>t in e?Ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Oe=(e,t)=>{for(var n in t||(t={}))I.call(t,n)&&B(e,n,t[n]);if(k)for(var n of k(t))K.call(t,n)&&B(e,n,t[n]);return e},Ce=(e,t)=>{var n={};for(var i in e)I.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&k)for(var i of k(e))t.indexOf(i)<0&&K.call(e,i)&&(n[i]=e[i]);return n};const Q=r.forwardRef((e,t)=>{var n=e,{color:i="currentColor"}=n,a=Ce(n,["color"]);return r.createElement("svg",Oe({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},a),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M12.611 5.056v6.222c0 .982-.795 1.778-1.778 1.778H4.167a1.777 1.777 0 0 1-1.778-1.778V5.056M13.056 1.944H1.944a.89.89 0 0 0-.888.89v1.333c0 .49.398.888.888.888h11.112a.89.89 0 0 0 .888-.888V2.833a.89.89 0 0 0-.889-.889M5.722 7.722h3.556"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});Q.displayName="ArchiveBox";var $e=Object.defineProperty,b=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,R=(e,t,n)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Pe=(e,t)=>{for(var n in t||(t={}))G.call(t,n)&&R(e,n,t[n]);if(b)for(var n of b(t))J.call(t,n)&&R(e,n,t[n]);return e},Se=(e,t)=>{var n={};for(var i in e)G.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&b)for(var i of b(e))t.indexOf(i)<0&&J.call(e,i)&&(n[i]=e[i]);return n};const U=r.forwardRef((e,t)=>{var n=e,{color:i="currentColor"}=n,a=Se(n,["color"]);return r.createElement("svg",Pe({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},a),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M10.6918 3.42715L6.96541 4.49011C6.50807 4.62056 6.24309 5.09706 6.37354 5.5544L7.31839 8.86672C7.44885 9.32405 7.92535 9.58904 8.38269 9.45858L12.109 8.39563C12.5664 8.26517 12.8314 7.78867 12.7009 7.33133L11.7561 4.01901C11.6256 3.56168 11.1491 3.29669 10.6918 3.42715Z",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M8.82837 3.95886L9.30112 5.61478",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M7.37573 12.2083L14.6736 10.127",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M5.43299 10.8572L3.26988 3.24407C3.16482 2.87379 2.8264 2.61804 2.44149 2.61804H1.54163",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"}),r.createElement("path",{d:"M5.84728 13.8125C6.67954 13.8125 7.35422 13.1378 7.35422 12.3055C7.35422 11.4733 6.67954 10.7986 5.84728 10.7986C5.01501 10.7986 4.34033 11.4733 4.34033 12.3055C4.34033 13.1378 5.01501 13.8125 5.84728 13.8125Z",stroke:"#52525B",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});U.displayName="HandTruck";var Ee=Object.defineProperty,w=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,H=(e,t,n)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Te=(e,t)=>{for(var n in t||(t={}))X.call(t,n)&&H(e,n,t[n]);if(w)for(var n of w(t))ee.call(t,n)&&H(e,n,t[n]);return e},Me=(e,t)=>{var n={};for(var i in e)X.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&w)for(var i of w(e))t.indexOf(i)<0&&ee.call(e,i)&&(n[i]=e[i]);return n};const E=r.forwardRef((e,t)=>{var n=e,{color:i="currentColor"}=n,a=Me(n,["color"]);return r.createElement("svg",Te({xmlns:"http://www.w3.org/2000/svg",width:15,height:15,fill:"none",ref:t},a),r.createElement("g",{stroke:i,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,clipPath:"url(#a)"},r.createElement("path",{d:"M5.056 1.982v9.333M9.944 3.685v9.333M1.752 2.679 4.802 2a.9.9 0 0 1 .497.032l4.402 1.601c.159.058.331.07.497.032l2.665-.592a.888.888 0 0 1 1.081.868v7.513c0 .417-.29.778-.696.867l-3.05.679a.9.9 0 0 1-.497-.032l-4.402-1.601a.9.9 0 0 0-.497-.032l-2.665.592a.89.89 0 0 1-1.081-.868V3.546c0-.417.29-.778.696-.867"})),r.createElement("defs",null,r.createElement("clipPath",{id:"a"},r.createElement("path",{fill:"#fff",d:"M0 0h15v15H0z"}))))});E.displayName="Map";var T="name,*sales_channels,*address,fulfillment_sets.type,fulfillment_sets.name,*fulfillment_sets.service_zones.geo_zones,*fulfillment_sets.service_zones,*fulfillment_sets.service_zones.shipping_options,*fulfillment_sets.service_zones.shipping_options.rules,*fulfillment_sets.service_zones.shipping_options.shipping_profile,*fulfillment_providers",De=e=>({queryKey:re.detail(e,{fields:T}),queryFn:async()=>await le.admin.stockLocation.retrieve(e,{fields:T}).catch(t=>{throw t.status===401?ce("/login"):t})}),ms=async({params:e})=>{const t=e.location_id,n=De(t);return Z.getQueryData(n.queryKey)??await Z.fetchQuery(n)},ze=({location:e})=>{var t,n;return s.jsxs(s.Fragment,{children:[s.jsx(C,{className:"p-0",children:s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsxs("div",{children:[s.jsx(L,{children:e.name}),s.jsx(x,{className:"text-ui-fg-subtle txt-small",children:be({address:e.address}).join(", ")})]}),s.jsx(Fe,{location:e})]})}),s.jsx(q,{locationId:e.id,locationName:e.name,type:"pickup",fulfillmentSet:(t=e.fulfillment_sets)==null?void 0:t.find(i=>i.type==="pickup")}),s.jsx(q,{locationId:e.id,locationName:e.name,type:"shipping",fulfillmentSet:(n=e.fulfillment_sets)==null?void 0:n.find(i=>i.type==="shipping")})]})};function W({option:e,fulfillmentSetId:t,locationId:n}){const i=O(),{t:a}=h(),l=se(e),{mutateAsync:o}=ke(e.id),p=async()=>{await i({title:a("general.areYouSure"),description:a("stockLocations.shippingOptions.delete.confirmation",{name:e.name}),verificationInstruction:a("general.typeToConfirm"),verificationText:e.name,confirmText:a("actions.delete"),cancelText:a("actions.cancel")})&&await o(void 0,{onSuccess:()=>{m.success(a("stockLocations.shippingOptions.delete.successToast",{name:e.name}))},onError:j=>{m.error(j.message)}})};return s.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[s.jsx("div",{className:"flex-1",children:s.jsxs(x,{size:"small",weight:"plus",children:[e.name," - ",e.shipping_profile.name," (",Y(e.provider_id),")"]})}),s.jsx(ve,{className:"mr-4",color:l?"grey":"purple",size:"2xsmall",rounded:"full",children:a(l?"general.store":"general.admin")}),s.jsx(g,{groups:[{actions:[{icon:s.jsx(_,{}),label:a("stockLocations.shippingOptions.edit.action"),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.service_zone_id}/shipping-option/${e.id}/edit`},{label:a("stockLocations.shippingOptions.pricing.action"),icon:s.jsx(je,{}),to:`/settings/locations/${n}/fulfillment-set/${t}/service-zone/${e.service_zone_id}/shipping-option/${e.id}/pricing`}]},{actions:[{label:a("actions.delete"),icon:s.jsx(N,{}),onClick:p}]}]})]})}function Ze({zone:e,locationId:t,fulfillmentSetId:n}){const{t:i}=h(),a=e.shipping_options.filter(o=>!y(o)),l=e.shipping_options.filter(o=>y(o));return s.jsxs("div",{children:[s.jsx(F,{variant:"dashed"}),s.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[s.jsxs("div",{className:"item-center flex justify-between",children:[s.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.shipping.label")}),s.jsx(z,{to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.id}/shipping-option/create`,children:i("stockLocations.shippingOptions.create.action")})]}),!!a.length&&s.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:a.map(o=>s.jsx(W,{option:o,locationId:t,fulfillmentSetId:n},o.id))})]}),s.jsx(F,{variant:"dashed"}),s.jsxs("div",{className:"flex flex-col gap-y-4 px-6 py-4",children:[s.jsxs("div",{className:"item-center flex justify-between",children:[s.jsx("span",{className:"text-ui-fg-subtle txt-small self-center font-medium",children:i("stockLocations.shippingOptions.create.returns.label")}),s.jsx(z,{to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.id}/shipping-option/create?is_return`,children:i("stockLocations.shippingOptions.create.action")})]}),!!l.length&&s.jsx("div",{className:"shadow-elevation-card-rest bg-ui-bg-subtle grid divide-y rounded-md",children:l.map(o=>s.jsx(W,{option:o,locationId:t,fulfillmentSetId:n},o.id))})]})]})}function Ae({zone:e,locationId:t,fulfillmentSetId:n}){const{t:i}=h(),a=O(),[l,o]=r.useState(!0),{mutateAsync:p}=ye(n,e.id),v=async()=>{await a({title:i("general.areYouSure"),description:i("stockLocations.serviceZones.delete.confirmation",{name:e.name}),confirmText:i("actions.delete"),cancelText:i("actions.cancel")})&&await p(void 0,{onError:f=>{m.error(f.message)},onSuccess:()=>{m.success(i("stockLocations.serviceZones.delete.successToast",{name:e.name}))}})},j=r.useMemo(()=>{const d=e.geo_zones.filter(c=>c.type==="country"),f=d.map(({country_code:c})=>fe.find(u=>u.iso_2===c)).filter(c=>!!c);return d.length!==f.length&&console.warn("Some countries are missing in the static countries list",d.filter(c=>!f.find(u=>u.iso_2===c.country_code)).map(c=>c.country_code)),f.sort((c,u)=>c.name.localeCompare(u.name))},[e.geo_zones]),[$,P]=r.useMemo(()=>{const d=e.shipping_options,f=d.filter(u=>!y(u)).length,c=d.filter(y).length;return[f,c]},[e.shipping_options]);return s.jsxs("div",{className:"flex flex-col",children:[s.jsxs("div",{className:"flex flex-row items-center justify-between gap-x-4 px-6 py-4",children:[s.jsx(M,{children:s.jsx(E,{})}),s.jsxs("div",{className:"grow-1 flex flex-1 flex-col",children:[s.jsx(x,{size:"small",leading:"compact",weight:"plus",children:e.name}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(V,{variant:"base",list:j.map(d=>d.display_name),inline:!0,n:1}),s.jsx("span",{children:"·"}),s.jsx(x,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.shipping",{count:$})}),s.jsx("span",{children:"·"}),s.jsx(x,{className:"text-ui-fg-subtle txt-small",children:i("stockLocations.shippingOptions.fields.count.returns",{count:P})})]})]}),s.jsxs("div",{className:"flex grow-0 items-center gap-4",children:[s.jsx(ue,{size:"small",onClick:()=>o(d=>!d),variant:"transparent",children:s.jsx(he,{style:{transform:`rotate(${l?180:0}deg)`,transition:".2s transform ease-in-out"}})}),s.jsx(g,{groups:[{actions:[{label:i("actions.edit"),icon:s.jsx(_,{}),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.id}/edit`},{label:i("stockLocations.serviceZones.manageAreas.action"),icon:s.jsx(E,{}),to:`/settings/locations/${t}/fulfillment-set/${n}/service-zone/${e.id}/areas`}]},{actions:[{label:i("actions.delete"),icon:s.jsx(N,{}),onClick:v}]}]})]})]}),l&&s.jsx(Ze,{fulfillmentSetId:n,locationId:t,zone:e})]})}function q(e){const{t}=h(),n=O(),{fulfillmentSet:i,locationName:a,locationId:l,type:o}=e,p=!!i,v=!!(i!=null&&i.service_zones.length),{mutateAsync:j}=de(l),{mutateAsync:$}=_e(i==null?void 0:i.id),P=async()=>{await j({name:`${a} ${o==="pickup"?"pick up":o}`,type:o},{onSuccess:()=>{m.success(t(`stockLocations.fulfillmentSets.enable.${o}`))},onError:c=>{m.error(c.message)}})},d=async()=>{await n({title:t("general.areYouSure"),description:t("stockLocations.fulfillmentSets.disable.confirmation",{name:i==null?void 0:i.name}),confirmText:t("actions.disable"),cancelText:t("actions.cancel")})&&await $(void 0,{onSuccess:()=>{m.success(t(`stockLocations.fulfillmentSets.disable.${o}`))},onError:u=>{m.error(u.message)}})},f=i?[{actions:[{icon:s.jsx(A,{}),label:t("stockLocations.serviceZones.create.action"),to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`}]},{actions:[{icon:s.jsx(N,{}),label:t("actions.disable"),onClick:d}]}]:[{actions:[{icon:s.jsx(A,{}),label:t("actions.enable"),onClick:P}]}];return s.jsx(C,{className:"p-0",children:s.jsxs("div",{className:"flex flex-col divide-y",children:[s.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[s.jsx(L,{level:"h2",children:t(`stockLocations.fulfillmentSets.${o}.header`)}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(Le,{color:p?"green":"grey",children:t(p?"statuses.enabled":"statuses.disabled")}),s.jsx(g,{groups:f})]})]}),p&&!v&&s.jsx("div",{className:"flex items-center justify-center py-8 pt-6",children:s.jsx(D,{message:t("stockLocations.serviceZones.fields.noRecords"),className:"h-fit",action:{to:`/settings/locations/${l}/fulfillment-set/${i.id}/service-zones/create`,label:t("stockLocations.serviceZones.create.action")}})}),v&&s.jsx("div",{className:"flex flex-col divide-y",children:i==null?void 0:i.service_zones.map(c=>s.jsx(Ae,{zone:c,locationId:l,fulfillmentSetId:i.id},c.id))})]})})}var Fe=({location:e})=>{const t=pe(),{t:n}=h(),{mutateAsync:i}=me(e.id),a=O(),l=async()=>{await a({title:n("general.areYouSure"),description:n("stockLocations.delete.confirmation",{name:e.name}),verificationText:e.name,verificationInstruction:n("general.typeToConfirm"),confirmText:n("actions.delete"),cancelText:n("actions.cancel")})&&await i(void 0,{onSuccess:()=>{m.success(n("stockLocations.create.successToast",{name:e.name})),t("/settings/locations",{replace:!0})},onError:p=>{m.error(p.message)}})};return s.jsx(g,{groups:[{actions:[{icon:s.jsx(_,{}),label:n("actions.edit"),to:"edit"},{icon:s.jsx(Q,{}),label:n("stockLocations.edit.viewInventory"),to:`/inventory?location_id=${e.id}`}]},{actions:[{icon:s.jsx(N,{}),label:n("actions.delete"),onClick:l}]}]})};function Be({location:e}){var a,l,o;const{t}=h(),{count:n}=xe({limit:1,fields:"id"}),i=!!((a=e.sales_channels)!=null&&a.length);return s.jsxs(C,{className:"flex flex-col px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(L,{level:"h2",children:t("stockLocations.salesChannels.header")}),s.jsx(g,{groups:[{actions:[{label:t("actions.edit"),to:"sales-channels",icon:s.jsx(_,{})}]}]})]}),i?s.jsxs("div",{className:"flex flex-col gap-y-4 pt-4",children:[s.jsxs("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3",children:[s.jsx(M,{children:s.jsx(we,{className:"text-ui-fg-subtle"})}),s.jsx(V,{n:3,className:"text-ui-fg-base",inline:!0,list:((l=e.sales_channels)==null?void 0:l.map(p=>p.name))??[]})]}),s.jsx(x,{className:"text-ui-fg-subtle",size:"small",leading:"compact",children:t("stockLocations.salesChannels.connectedTo",{count:(o=e.sales_channels)==null?void 0:o.length,total:n})})]}):s.jsx(D,{className:"h-fit pb-2 pt-6",action:{label:t("stockLocations.salesChannels.action"),to:"sales-channels"},message:t("stockLocations.salesChannels.noChannels")})]})}var Re=Be;function He({location:e}){const{t}=h(),{fulfillment_providers:n}=ge({stock_location_id:e.id,fields:"id",is_enabled:!0});return s.jsxs(C,{className:"flex flex-col px-6 py-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(L,{level:"h2",children:t("stockLocations.fulfillmentProviders.header")}),s.jsx(g,{groups:[{actions:[{label:t("actions.edit"),to:"fulfillment-providers",icon:s.jsx(_,{})}]}]})]}),n!=null&&n.length?s.jsx("div",{className:"flex flex-col gap-y-4 pt-4",children:s.jsx("div",{className:"grid grid-cols-[28px_1fr] items-center gap-x-3 gap-y-3",children:n==null?void 0:n.map(i=>s.jsxs(s.Fragment,{children:[s.jsx(M,{children:s.jsx(U,{className:"text-ui-fg-subtle"})}),s.jsx("div",{className:"txt-compact-small",children:Y(i.id)})]}))})}):s.jsx(D,{className:"h-fit pb-2 pt-6 text-center",action:{label:t("stockLocations.fulfillmentProviders.action"),to:"fulfillment-providers"},message:t("stockLocations.fulfillmentProviders.noProviders")})]})}var We=He,fs=()=>{const e=te(),{location_id:t}=ne(),{stock_location:n,isPending:i,isError:a,error:l}=ie(t,{fields:T},{initialData:e}),{getWidgets:o}=ae();if(i||!n)return s.jsx(oe,{mainSections:3,sidebarSections:2,showJSON:!0});if(a)throw l;return s.jsxs(S,{widgets:{after:o("location.details.after"),before:o("location.details.before"),sideAfter:o("location.details.side.after"),sideBefore:o("location.details.side.before")},data:n,showJSON:!0,hasOutlet:!0,children:[s.jsx(S.Main,{children:s.jsx(ze,{location:n})}),s.jsxs(S.Sidebar,{children:[s.jsx(Re,{location:n}),s.jsx(We,{location:n})]})]})};export{fs as Component,ms as loader};
