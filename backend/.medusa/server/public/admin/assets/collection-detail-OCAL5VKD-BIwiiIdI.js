import{u as N}from"./chunk-VWNSX5WA-CTC_4jUd.js";import{d as I,R as _,dA as z,a as M,j as o,dB as Q,q as y,b as p,u as H,dy as L,H as b,A as g,T as f,e as O,k as W,dC as C,Y,r as K,dD as $,s as B,t as d}from"./index-Bq0Gzu_3.js";import{u as F,a as G}from"./chunk-B5GTMFNM-BU4EN_GG.js";import{S as J}from"./chunk-UR2E444G-BOK0EhlY.js";import"./chunk-3IW4HYUP-B8Byj9_3.js";import{u as U,D as Z}from"./chunk-OMP35ZTD-TafmhEGJ.js";import"./lodash-C7_NW7v3.js";import"./chunk-2XYHZG6S-C03r6v2Q.js";import"./chunk-E3YGDIJC-DwOUC-jK.js";import{P as S}from"./pencil-square-DJB9OGX8.js";import{T as P}from"./trash-WzBoCVyR.js";import{u as x}from"./use-prompt-DKUUp42P.js";import{C as w}from"./container-Dy7007w-.js";import{C as v}from"./checkbox-_V0gwTuy.js";import{c as V}from"./index-DSyUmAUn.js";import"./chunk-FTXJRXMD-BteamdRa.js";import"./chunk-ADOCJB6L-lgk_ht_6.js";import"./chunk-P3UUX2T6-DJzunWlg.js";import"./chunk-C76H5USB-B1mKOCrZ.js";import"./Trans-D-2atTey.js";import"./x-mark-mini-B2FnFGkK.js";import"./chunk-YEDAFXMB-BLUM5VK_.js";import"./chunk-AOFGTNG6-C3IFjf4O.js";import"./chunk-WX2SMNCD-CUPtxgvy.js";import"./plus-mini-D38qrUji.js";import"./command-bar-DD70Q2dm.js";import"./index-C99Xhc7P.js";import"./chunk-QAF7PVQE-Cn23_qPf.js";import"./format-moz0PK7h.js";import"./date-picker-DLj21rEe.js";import"./popover-DVUhQEd-.js";import"./triangle-left-mini-C5FnHW24.js";import"./prompt-B670l_cz.js";var X=({collection:s})=>{const{t:e}=p(),t=x(),r=H(),{mutateAsync:i}=L(s.id),a=async()=>{await t({title:e("general.areYouSure"),description:e("collections.deleteWarning",{count:1,title:s.title})})&&(await i(),r("../",{replace:!0}))};return o.jsxs(w,{className:"divide-y p-0",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[o.jsx(b,{children:s.title}),o.jsx(g,{groups:[{actions:[{icon:o.jsx(S,{}),label:e("actions.edit"),to:`/collections/${s.id}/edit`,disabled:!s.id}]},{actions:[{icon:o.jsx(P,{}),label:e("actions.delete"),onClick:a,disabled:!s.id}]}]})]}),o.jsxs("div",{className:"text-ui-fg-subtle grid grid-cols-2 items-center px-6 py-4",children:[o.jsx(f,{size:"small",leading:"compact",weight:"plus",children:e("fields.handle")}),o.jsxs(f,{size:"small",children:["/",s.handle]})]})]})},l=10,ee=({collection:s})=>{const{t:e}=p(),{searchParams:t,raw:r}=F({pageSize:l}),{products:i,count:a,isLoading:n,isError:u,error:T}=O({limit:l,...t,collection_id:[s.id]},{placeholderData:W}),k=G(["collections"]),h=se(),{table:D}=U({data:i??[],columns:h,getRowId:c=>c.id,count:a,enablePagination:!0,enableRowSelection:!0,pageSize:l,meta:{collectionId:s.id}}),A=x(),{mutateAsync:R}=C(s.id),E=async c=>{const m=Object.keys(c);await A({title:e("general.areYouSure"),description:e("collections.removeProductsWarning",{count:m.length}),confirmText:e("actions.remove"),cancelText:e("actions.cancel")})&&await R({remove:m},{onSuccess:()=>{d.success(e("collections.products.remove.successToast",{count:m.length}))},onError:q=>{d.error(q.message)}})};if(u)throw T;return o.jsxs(w,{className:"divide-y p-0",children:[o.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[o.jsx(b,{level:"h2",children:e("products.domain")}),o.jsx(g,{groups:[{actions:[{icon:o.jsx(Y,{}),label:e("actions.add"),to:"products"}]}]})]}),o.jsx(Z,{table:D,columns:h,search:!0,pagination:!0,pageSize:l,navigateTo:({original:c})=>`/products/${c.id}`,count:a,filters:k,isLoading:n,orderBy:[{key:"title",label:e("fields.title")},{key:"created_at",label:e("fields.createdAt")},{key:"updated_at",label:e("fields.updatedAt")}],queryObject:r,commands:[{action:E,label:e("actions.remove"),shortcut:"r"}],noRecords:{message:e("collections.products.list.noRecordsMessage")}})]})},te=({product:s,collectionId:e})=>{const{t}=p(),r=x(),{mutateAsync:i}=C(e),a=async()=>{await r({title:t("general.areYouSure"),description:t("collections.removeSingleProductWarning",{title:s.title}),confirmText:t("actions.remove"),cancelText:t("actions.cancel")})&&await i({remove:[s.id]},{onSuccess:()=>{d.success(t("collections.products.remove.successToast",{count:1}))},onError:u=>{d.error(u.message)}})};return o.jsx(g,{groups:[{actions:[{icon:o.jsx(S,{}),label:t("actions.edit"),to:`/products/${s.id}/edit`}]},{actions:[{icon:o.jsx(P,{}),label:t("actions.remove"),onClick:a}]}]})},j=V(),se=()=>{const s=N();return K.useMemo(()=>[j.display({id:"select",header:({table:e})=>o.jsx(v,{checked:e.getIsSomePageRowsSelected()?"indeterminate":e.getIsAllPageRowsSelected(),onCheckedChange:t=>e.toggleAllPageRowsSelected(!!t)}),cell:({row:e})=>o.jsx(v,{checked:e.getIsSelected(),onCheckedChange:t=>e.toggleSelected(!!t),onClick:t=>{t.stopPropagation()}})}),...s,j.display({id:"actions",cell:({row:e,table:t})=>{const{collectionId:r}=t.options.meta;return o.jsx(te,{product:e.original,collectionId:r})}})],[s])},Qe=()=>{const s=I(),{id:e}=_(),{collection:t,isLoading:r,isError:i,error:a}=z(e,{initialData:s}),{getWidgets:n}=M();if(r||!t)return o.jsx(Q,{sections:2,showJSON:!0,showMetadata:!0});if(i)throw a;return o.jsxs(J,{widgets:{after:n("product_collection.details.after"),before:n("product_collection.details.before")},showJSON:!0,showMetadata:!0,data:t,children:[o.jsx(X,{collection:t}),o.jsx(ee,{collection:t})]})},oe=s=>({queryKey:$.detail(s),queryFn:async()=>B.admin.productCollection.retrieve(s)}),He=async({params:s})=>{const e=s.id,t=oe(e);return y.getQueryData(t.queryKey)??await y.fetchQuery(t)};export{Qe as Component,He as loader};
